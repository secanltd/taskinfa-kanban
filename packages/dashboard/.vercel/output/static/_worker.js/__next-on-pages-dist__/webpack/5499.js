var a={},f=(h,g,p)=>(a.__chunk_5499=(R,l,o)=>{"use strict";o.d(l,{Eb:()=>d,XP:()=>w,cr:()=>m});class c{constructor(){this.limits=new Map,this.cleanupInterval=null,this.cleanupInterval=setInterval(()=>{let e=Date.now();for(let[s,n]of this.limits.entries())n.resetAt<e&&this.limits.delete(s)},6e4)}check(e,s,n){let i=Date.now(),t=this.limits.get(e);return!t||t.resetAt<i?(this.limits.set(e,{count:1,resetAt:i+n}),{allowed:!0,remaining:s-1,resetAt:i+n}):(t.count++,t.count>s?{allowed:!1,remaining:0,resetAt:t.resetAt}:{allowed:!0,remaining:s-t.count,resetAt:t.resetAt})}reset(e){this.limits.delete(e)}cleanup(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null),this.limits.clear()}}let u=new c,m={LOGIN:{maxRequests:5,windowMs:9e5},SIGNUP:{maxRequests:3,windowMs:36e5},API_KEY_CREATE:{maxRequests:10,windowMs:36e5},API_GENERAL:{maxRequests:100,windowMs:6e4}};function d(r,e,s){let n=`${function(i){let t=i.headers.get("x-forwarded-for");return t?t.split(",")[0].trim():i.headers.get("x-real-ip")||"unknown"}(r)}:${e}`;return u.check(n,s.maxRequests,s.windowMs)}function w(r){let e=Math.ceil((r-Date.now())/1e3);return new Response(JSON.stringify({error:"Too many requests",message:"Rate limit exceeded. Please try again later.",retryAfter:e}),{status:429,headers:{"Content-Type":"application/json","Retry-After":e.toString(),"X-RateLimit-Limit":"0","X-RateLimit-Remaining":"0","X-RateLimit-Reset":new Date(r).toISOString()}})}},a);export{f as __getNamedExports};
